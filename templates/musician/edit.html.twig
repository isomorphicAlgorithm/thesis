{% extends 'base.html.twig' %}

{% block title %}Edit {{ musician.name }} | Bandito{% endblock %}

{% block body %}
<div class="min-h-screen bg-cover bg-center py-12">
    <div class="max-w-3xl mx-auto bg-black/70 backdrop-blur-md rounded-2xl shadow-xl p-8 space-y-6 border-2 border-yellow-500/60">
        <div class="flex items-center justify-between">
            <h1 class="text-3xl font-bold text-yellow-50 flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-8 text-yellow-400">
                    <path d="M8.25 4.5a3.75 3.75 0 1 1 7.5 0v8.25a3.75 3.75 0 1 1-7.5 0V4.5Z" />
                    <path d="M6 10.5a.75.75 0 0 1 .75.75v1.5a5.25 5.25 0 1 0 10.5 0v-1.5a.75.75 0 0 1 1.5 0v1.5a6.751 6.751 0 0 1-6 6.709v2.291h3a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1 0-1.5h3v-2.291a6.751 6.751 0 0 1-6-6.709v-1.5A.75.75 0 0 1 6 10.5Z" />
                </svg>
                Edit Musician -
                <span class="text-yellow-400">{{ musician.name }}</span>
            </h1>
            <a href="{{ path('musician_list') }}" class="text-yellow-400 hover:text-yellow-300 text-base font-semibold inline-flex items-center gap-2 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                </svg>
                Back to list
            </a>
        </div>

        {{ form_start(form, {
            attr: {
                class: 'grid grid-cols-1 sm:grid-cols-2 gap-6',
                enctype: 'multipart/form-data'
            }
        }) }}

            <!-- Name -->
            <div class="col-span-full">
                {{ form_label(form.name, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.name, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 placeholder-gray-400 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.name) }}
            </div>

            <!-- Active From -->
            <div>
                {{ form_label(form.activeFrom, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.activeFrom, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.activeFrom) }}
            </div>

            <!-- Active Until -->
            <div>
                {{ form_label(form.activeUntil, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.activeUntil, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.activeUntil) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Biography -->
            <div class="col-span-full">
                {{ form_label(form.bio, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.bio, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition', rows: 5 } }) }}
                {{ form_errors(form.bio) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Links -->
            {% include 'components/links.html.twig' %}

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Is Disbanded -->
            <div class="col-span-full flex items-center">
                {{ form_label(form.isDisbanded, null, { label_attr: { class: 'text-yellow-400 font-semibold cursor-pointer' } }) }}
                {{ form_widget(form.isDisbanded, { attr: { class: 'ml-2 h-5 w-5 text-yellow-500 transition cursor-pointer' } }) }}
                {{ form_errors(form.isDisbanded) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Current Cover Preview -->
            {% if musician.coverImage %}
                <div class="col-span-full">
                    <label class="text-yellow-400 font-semibold block mb-1">Current Cover</label>
                    <img src="{% if file_exists_in_public('uploads/musicians/' ~ musician.coverImage) %}{{ asset('uploads/musicians/' ~ musician.coverImage) }}{% else %}{{ musician.coverImage }}{% endif %}" alt="Current cover" class="mt-2 w-96 h-96 rounded-xl object-cover border-2 border-yellow-500/60 shadow-md object-cover" />
                </div>
                <hr class="col-span-full border-t border-yellow-500/30 my-4" />
            {% endif %}

            <!-- Cover Image Upload -->
            <div class="col-span-full">
                {{ form_label(form.coverImageFile, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                <div class="mt-2 flex items-center gap-4">
                    {{ form_widget(form.coverImageFile, { attr: { class: 'text-yellow-50 file:bg-yellow-500 file:text-black file:rounded-lg file:px-4 file:py-2 transition' } }) }}
                </div>
                {{ form_errors(form.coverImageFile) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Genres -->
            <div class="col-span-full">
                {{ form_label(form.genres, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.genres, { attr: { class: 'genre-select w-full' } }) }}
                {{ form_errors(form.genres) }}
            </div>

            <!-- Bands -->
            <div class="col-span-full">
                {{ form_label(form.bands, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.bands, { attr: { class: 'band-select w-full' } }) }}
                {{ form_errors(form.bands) }}
            </div>

            <!-- Albums -->
            <div class="col-span-full">
                {{ form_label(form.albums, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.albums, { attr: { class: 'album-select w-full' } }) }}
                {{ form_errors(form.albums) }}
            </div>

            <!-- Songs Autocomplete -->
            <div class="col-span-full">
                {{ form_label(form.songs, 'Songs', {
                    label_attr: { class: 'text-yellow-400 font-semibold block mb-1' }
                    }) }}
                {{ form_widget(form.songs, {
                    id: 'song-select',
                    attr: {
                        'data-autocomplete-url': path('autocomplete_songs')
                    }
                }) }}
                {{ form_errors(form.songs) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Submit Buttons -->
            <div class="col-span-full flex justify-end gap-4 mt-4">
                <a href="{{ path('musician_list') }}" class="inline-block px-6 py-2 bg-red-600 rounded-xl text-white custom-shadow hover:text-yellow-400 transition">Cancel</a>
                <button type="submit" class="inline-flex items-center gap-2 bg-yellow-500 text-black font-semibold px-6 py-2 rounded-2xl custom-shadow transition cursor-pointer">Save Changes</button>
            </div>

        {{ form_row(form._token) }}
        {{ form_end(form, { render_rest: false }) }}
    </div>
</div>
{% endblock %}
