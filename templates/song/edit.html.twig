{% extends 'base.html.twig' %}

{% block title %}Edit {{ song.title }} | Bandito{% endblock %}

{% block body %}
<div class="min-h-screen bg-cover bg-center py-12">
    <div class="max-w-3xl mx-auto bg-black/70 backdrop-blur-md rounded-2xl shadow-xl p-8 space-y-6 border-2 border-yellow-500/60">
        <div class="flex items-center justify-between">
            <h1 class="text-3xl font-bold text-yellow-50 flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="currentColor" class="size-8 text-yellow-400">
                    <path fill-rule="evenodd" d="M19.952 1.651a.75.75 0 0 1 .298.599V16.303a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.403-4.909l2.311-.66a1.5 1.5 0 0 0 1.088-1.442V6.994l-9 2.572v9.737a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.402-4.909l2.31-.66a1.5 1.5 0 0 0 1.088-1.442V5.25a.75.75 0 0 1 .544-.721l10.5-3a.75.75 0 0 1 .658.122Z" clip-rule="evenodd"/>
                </svg>
                Edit Song -
                <span class="text-yellow-400">{{ song.title }}</span>
            </h1>
            <a href="{{ path('song_list') }}" class="text-yellow-400 hover:text-yellow-300 text-base font-semibold inline-flex items-center gap-2 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                </svg>
                Back to list
            </a>
        </div>

        {{ form_start(form, {
            attr: {
                class: 'grid grid-cols-1 sm:grid-cols-2 gap-6',
                enctype: 'multipart/form-data'
            }
        }) }}

            <!-- Title -->
            <div class="col-span-full">
                {{ form_label(form.title, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.title, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 placeholder-gray-400 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.title) }}
            </div>

            <!-- Release Date -->
            <div>
                {{ form_label(form.track_number, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.track_number, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.track_number) }}
            </div>

            <!-- Release Date -->
            <div>
                {{ form_label(form.release_date, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.release_date, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.release_date) }}
            </div>

            <!-- Duration -->
            <div>
                {{ form_label(form.duration, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.duration, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.duration) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Description -->
            <div class="col-span-full">
                {{ form_label(form.description, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.description, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition', rows: 5 } }) }}
                {{ form_errors(form.description) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Links -->
            {% include 'components/links.html.twig' %}

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Current Cover Preview -->
            {% if song.coverImage %}
                <div class="col-span-full">
                    <label class="text-yellow-400 font-semibold block mb-1">Current Cover</label>
                    <img src="{% if file_exists_in_public('uploads/songs/' ~ song.coverImage) %}{{ asset('uploads/songs/' ~ song.coverImage) }}{% else %}{{ song.coverImage }}{% endif %}" alt="Current cover" class="mt-2 w-96 h-96 rounded-xl object-cover border-2 border-yellow-500/60 shadow-md object-cover" />
                </div>
                <hr class="col-span-full border-t border-yellow-500/30 my-4" />
            {% endif %}

            <!-- Cover Image Upload -->
            <div class="col-span-full">
                {{ form_label(form.coverImageFile, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                <div class="mt-2 flex items-center gap-4">
                    {{ form_widget(form.coverImageFile, { attr: { class: 'text-yellow-50 file:bg-yellow-500 file:text-black file:rounded-lg file:px-4 file:py-2 transition' } }) }}
                </div>
                {{ form_errors(form.coverImageFile) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Genres -->
            <div class="col-span-full">
                {{ form_label(form.genres, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.genres, { attr: { class: 'genre-select w-full' } }) }}
                {{ form_errors(form.genres) }}
            </div>

            <!-- Bands -->
            <div class="col-span-full">
                {{ form_label(form.bands, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.bands, { attr: { class: 'band-select w-full' } }) }}
                {{ form_errors(form.bands) }}
            </div>

            <!-- Musicians -->
            <div class="col-span-full">
                {{ form_label(form.musicians, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.musicians, { attr: { class: 'musician-select w-full' } }) }}
                {{ form_errors(form.musicians) }}
            </div>

            <!-- Albums -->
            <div class="col-span-full">
                {{ form_label(form.albums, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.albums, { attr: { class: 'album-select w-full' } }) }}
                {{ form_errors(form.albums) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Submit Buttons -->
            <div class="col-span-full flex justify-end gap-4 mt-4">
                <a href="{{ path('song_list') }}" class="inline-block px-6 py-2 bg-red-600 rounded-xl text-white custom-shadow hover:text-yellow-400 transition">Cancel</a>
                <button type="submit" class="inline-flex items-center gap-2 bg-yellow-500 text-black font-semibold px-6 py-2 rounded-2xl custom-shadow transition cursor-pointer">Save Changes</button>
            </div>

        {{ form_row(form._token) }}
        {{ form_end(form, { render_rest: false }) }}
    </div>
</div>
{% endblock %}
