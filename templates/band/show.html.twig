{% extends 'base.html.twig' %}

{% block title %}{{ band.name }}{% endblock %}

{% block body %}
    <div class="container mx-auto p-6">

        <!-- Band Layout Split -->
        <div class="flex flex-col md:flex-row gap-6 bg-black/70 text-yellow-50 p-6 border-2 border-yellow-500/60 rounded-2xl shadow-md mb-6">

            <!-- LEFT COLUMN: Image + Basic Info + Links -->
            <div class="w-full md:w-1/3 space-y-6">
                <!-- Band Cover Image -->
                {% if band.coverImage %}
                    <img src="{% if file_exists_in_public('uploads/bands/' ~ band.coverImage) %}{{ asset('uploads/bands/' ~ band.coverImage) }}{% else %}{{ band.coverImage }}{% endif %}" alt="{{ band.name }}" class="w-full h-auto rounded-xl object-cover border-2 border-yellow-500/60 shadow-md">
                {% else %}
                    <div class="w-full h-40 rounded-xl bg-gray-700 flex items-center justify-center text-gray-300 text-xl shadow-lg">
                        No Cover Image
                    </div>
                {% endif %}

                <!-- Band Name + Active Years -->
                <div>
                    <h1 class="text-3xl font-bold">{{ band.name }}</h1>
                    <p class="text-sm text-gray-400 mt-1 flex items-center gap-1.5">
                        <svg class="size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M6.75 3v1.5m10.5-1.5v1.5M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25M3 18.75A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75M3 18.75v-8.25a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 10.5v8.25" />
                        </svg>
                        Years Active: {{ band.activeFrom|date('F Y') }} - {{ band.activeUntil|date('F Y') }}
                    </p>
                </div>

                <!-- Links -->
                {% if band.links %}
                    <div>
                        <h2 class="text-lg font-semibold text-yellow-50 mb-2 flex items-center gap-2">
                            <i class="fas fa-link text-yellow-400"></i> Links
                        </h2>
                        <div class="flex flex-wrap gap-4 items-center">
                            {% include 'partials/_social_links.html.twig' with { links: band.links } %}
                        </div>
                    </div>
                {% endif %}
            </div>

            <!-- RIGHT COLUMN: Bio + Members + Albums -->
            <div class="w-full md:w-2/3 space-y-10">
                <!-- Bio -->
                <div>
                    <h2 class="text-xl font-bold mb-4 text-yellow-50 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="text-yellow-400 size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
                        </svg>
                        About
                    </h2>
                    <div class="text-gray-300 leading-relaxed [&_a]:text-blue-500 [&_a]:hover:underline">
                        {{ band.bio|raw ?: 'No bio provided yet.' }}
                    </div>
                </div>

                <!-- Genres -->
                <div>
                    <h2 class="text-xl font-bold mb-4 text-yellow-50 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke-width="1.5" class="text-yellow-400 size-6">
                            <path fill-rule="evenodd" d="M5.636 4.575a.75.75 0 0 1 0 1.061 9 9 0 0 0 0 12.728.75.75 0 1 1-1.06 1.06c-4.101-4.1-4.101-10.748 0-14.849a.75.75 0 0 1 1.06 0Zm12.728 0a.75.75 0 0 1 1.06 0c4.101 4.1 4.101 10.75 0 14.85a.75.75 0 1 1-1.06-1.061 9 9 0 0 0 0-12.728.75.75 0 0 1 0-1.06ZM7.757 6.697a.75.75 0 0 1 0 1.06 6 6 0 0 0 0 8.486.75.75 0 0 1-1.06 1.06 7.5 7.5 0 0 1 0-10.606.75.75 0 0 1 1.06 0Zm8.486 0a.75.75 0 0 1 1.06 0 7.5 7.5 0 0 1 0 10.606.75.75 0 0 1-1.06-1.06 6 6 0 0 0 0-8.486.75.75 0 0 1 0-1.06ZM9.879 8.818a.75.75 0 0 1 0 1.06 3 3 0 0 0 0 4.243.75.75 0 1 1-1.061 1.061 4.5 4.5 0 0 1 0-6.364.75.75 0 0 1 1.06 0Zm4.242 0a.75.75 0 0 1 1.061 0 4.5 4.5 0 0 1 0 6.364.75.75 0 0 1-1.06-1.06 3 3 0 0 0 0-4.243.75.75 0 0 1 0-1.061ZM10.875 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z" clip-rule="evenodd" />
                        </svg>
                        Genres
                    </h2>
                    <div class="text-gray-300 leading-relaxed">
                        {% if band.genres|length > 0 %}
                            {% for genre in band.genres %}
                                {{ genre.displayName }}{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        {% else %}-{% endif %}
                    </div>
                </div>

                <!-- Albums -->
                <div>
                    <div class="flex items-center justify-between mb-2">
                        <h2 class="text-xl font-bold text-yellow-50 mb-4 flex items-center gap-2">
                            <svg class="text-yellow-400 size-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="8" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                            Albums
                        </h2>

                        <div class="flex items-center gap-2">
                            <a href="{{ path('album_list', { band_id: band.id }) }}"
                                class="bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-1 px-4 rounded transition custom-shadow">
                                View All Albums
                            </a>
                            {% if band.albums|length > 4 %}
                                <span class="text-sm text-yellow-300 bg-yellow-600/10 px-3 py-1 rounded-full border border-yellow-500">
                                    +{{ band.albums|length - 4 }} more
                                </span>
                            {% endif %}
                        </div>
                    </div>

                    {% if band.albums|length > 0 %}
                        <div class="swiper mySwiper">
                            <div class="swiper-wrapper flex-nowrap">
                               {% for album in band.albums|slice(0, 4) %}
                                    <div class="swiper-slide !w-60 flex-shrink-0 rounded-xl p-2">
                                        <a
                                            href="{{ path('album_show', { id: album.id, slug: album.slug }) }}"
                                            class="block transform hover:bg-yellow-500/20 hover:scale-105 bg-black/70 transition duration-300 rounded-xl p-2"
                                        >
                                            <img
                                                src="{% if file_exists_in_public('uploads/albums/' ~ album.coverImage) %}
                                                        {{ asset('uploads/albums/' ~ album.coverImage) }}
                                                    {% else %}
                                                        {{ album.coverImage }}
                                                    {% endif %}"
                                                class="rounded-lg w-full h-auto aspect-[4/4] object-cover"
                                                alt="{{ album.title }}"
                                            >
                                            <p class="text-white text-center mt-2 font-semibold">{{ album.title }}</p>
                                        </a>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% else %}
                        <p class="text-gray-400">No albums listed.</p>
                    {% endif %}
                </div>

                <!-- Members-Members -->
                <div class="mt-4">
                    <h2 class="text-xl font-bold text-yellow-50 mb-4 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6 text-yellow-400">
                            <path d="M4.5 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM14.25 8.625a3.375 3.375 0 1 1 6.75 0 3.375 3.375 0 0 1-6.75 0ZM1.5 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM17.25 19.128l-.001.144a2.25 2.25 0 0 1-.233.96 10.088 10.088 0 0 0 5.06-1.01.75.75 0 0 0 .42-.643 4.875 4.875 0 0 0-6.957-4.611 8.586 8.586 0 0 1 1.71 5.157v.003Z" />
                        </svg>
                        Members
                    </h2>

                    {% if band.musicians|length > 0 %}
                        <div class="grid gap-8 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6">
                            {% for musician in band.musicians %}
                                <div class="text-center">
                                    <a href="{{ path('musician_show', { id: musician.id, slug: musician.slug }) }}"
                                    class="block w-24 h-24 mx-auto rounded-full overflow-hidden border-4 border-yellow-400 shadow-lg custom-shadow transition-transform hover:scale-110">
                                        <img
                                            src="{% if file_exists_in_public('uploads/musicians/' ~ musician.coverImage) %}{{ asset('uploads/musicians/' ~ musician.coverImage) }}{% else %}{{ musician.coverImage }}{% endif %}"
                                            alt="{{ musician.name }}"
                                            class="w-full h-full object-cover"
                                        >
                                    </a>
                                    <p class="text-yellow-50 font-semibold mt-3 text-lg hover:text-yellow-400 transition-colors">
                                        {{ musician.name }}
                                    </p>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-gray-400">No musicians listed.</p>
                    {% endif %}
                </div>
            </div>

        </div>

    </div>
{% endblock %}