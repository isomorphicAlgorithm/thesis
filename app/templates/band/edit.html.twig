{% extends 'base.html.twig' %}

{% block title %}Edit {{ band.name }} | Bandito{% endblock %}

{% block body %}
<div class="min-h-screen bg-cover bg-center py-12">
    <div class="max-w-3xl mx-auto bg-black/70 backdrop-blur-md rounded-2xl shadow-xl p-8 space-y-6 border-2 border-yellow-500/60">
        <div class="flex items-center justify-between">
            <h1 class="text-3xl font-bold text-yellow-50 flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-8 text-yellow-400">
                    <path fill-rule="evenodd" d="M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z" clip-rule="evenodd" />
                    <path d="M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z" />
                </svg>
                Edit Band -
                <span class="text-yellow-400">{{ band.name }}</span>
            </h1>
            <a href="{{ path('band_list') }}" class="text-yellow-400 hover:text-yellow-300 text-base font-semibold inline-flex items-center gap-2 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                </svg>
                Back to list
            </a>
        </div>

        {{ form_start(form, {
            attr: {
                class: 'grid grid-cols-1 sm:grid-cols-2 gap-6',
                enctype: 'multipart/form-data'
            }
        }) }}

            <!-- Name -->
            <div class="col-span-full">
                {{ form_label(form.name, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.name, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 placeholder-gray-400 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.name) }}
            </div>

            <!-- Active From -->
            <div>
                {{ form_label(form.activeFrom, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.activeFrom, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.activeFrom) }}
            </div>

            <!-- Active Until -->
            <div>
                {{ form_label(form.activeUntil, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.activeUntil, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition' } }) }}
                {{ form_errors(form.activeUntil) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Biography -->
            <div class="col-span-full">
                {{ form_label(form.bio, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.bio, { attr: { class: 'mt-1 w-full bg-zinc-800/80 text-yellow-50 border border-gray-700 rounded-lg px-4 py-2 transition', rows: 5 } }) }}
                {{ form_errors(form.bio) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Links -->
            {% include 'components/links.html.twig' %}

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Is Disbanded -->
            <div class="col-span-full flex items-center">
                {{ form_label(form.isDisbanded, null, { label_attr: { class: 'text-yellow-400 font-semibold cursor-pointer' } }) }}
                {{ form_widget(form.isDisbanded, { attr: { class: 'ml-2 h-5 w-5 text-yellow-500 transition cursor-pointer' } }) }}
                {{ form_errors(form.isDisbanded) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Current Cover Preview -->
            {% if band.coverImage %}
                <div class="col-span-full">
                    <label class="text-yellow-400 font-semibold block mb-1">Current Cover</label>
                    <img src="{% if file_exists_in_public('uploads/bands/' ~ band.coverImage) %}{{ asset('uploads/bands/' ~ band.coverImage) }}{% else %}{{ band.coverImage }}{% endif %}" alt="Current cover" class="mt-2 w-96 h-96 rounded-xl object-cover border-2 border-yellow-500/60 shadow-md object-cover" />
                </div>
                <hr class="col-span-full border-t border-yellow-500/30 my-4" />
            {% endif %}

            <!-- Cover Image Upload -->
            <div class="col-span-full">
                {{ form_label(form.coverImageFile, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                <div class="mt-2 flex items-center gap-4">
                    {{ form_widget(form.coverImageFile, { attr: { class: 'text-yellow-50 file:bg-yellow-500 file:text-black file:rounded-lg file:px-4 file:py-2 transition' } }) }}
                </div>
                {{ form_errors(form.coverImageFile) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Genres -->
            <div class="col-span-full">
                {{ form_label(form.genres, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.genres, { attr: { class: 'genre-select w-full' } }) }}
                {{ form_errors(form.genres) }}
            </div>

            <!-- Musicians -->
            <div class="col-span-full">
                {{ form_label(form.musicians, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.musicians, { attr: { class: 'musician-select w-full' } }) }}
                {{ form_errors(form.musicians) }}
            </div>

            <!-- Albums -->
            <div class="col-span-full">
                {{ form_label(form.albums, null, { label_attr: { class: 'text-yellow-400 font-semibold' } }) }}
                {{ form_widget(form.albums, { attr: { class: 'album-select w-full' } }) }}
                {{ form_errors(form.albums) }}
            </div>

            <!-- Songs Autocomplete -->
            <div class="col-span-full">
                {{ form_label(form.songs, 'Songs', {
                    label_attr: { class: 'text-yellow-400 font-semibold block mb-1' }
                    }) }}
                {{ form_widget(form.songs, {
                    id: 'song-select',
                    attr: {
                        'data-autocomplete-url': path('autocomplete_songs')
                    }
                }) }}
                {{ form_errors(form.songs) }}
            </div>

            <hr class="col-span-full border-t border-yellow-500/30 my-4" />

            <!-- Submit Buttons -->
            <div class="col-span-full flex justify-end gap-4 mt-4">
                <a href="{{ path('band_list') }}" class="inline-block px-6 py-2 bg-red-600 rounded-xl text-white custom-shadow hover:text-yellow-400 transition">Cancel</a>
                <button type="submit" class="inline-flex items-center gap-2 bg-yellow-500 text-black font-semibold px-6 py-2 rounded-2xl custom-shadow transition cursor-pointer">Save Changes</button>
            </div>

        {{ form_row(form._token) }}
        {{ form_end(form, { render_rest: false }) }}
    </div>
</div>
{% endblock %}
